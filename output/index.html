<!DOCTYPE html><html lang="en"><head>
    <meta charset="utf-8">
    <title>A Developer's Notebook - Home</title>
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/pure-min.css" integrity="sha384-oAOxQR6DkCoMliIh8yFnu25d7Eq/PHS21PClpwjOTeU2jRSq11vu66rf90/cZr47" crossorigin="anonymous">
    <link rel="stylesheet" href="assets/stylesheet.css">
    <link rel="stylesheet" href="assets/highlight.css">

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- you don't need to keep this, but it's cool for stats! -->
    <meta name="generator" content="Nanoc 4.11.9">
  </head>
  <body>
    <div id="layout">
      <div class="header">
        <h1>
          <a href="./">A Developer's Notebook</a>
        </h1>
      </div>


      <div class="content">
        <nav class="pure-g">
          <div class="pure-u-2-3 links">
            <a href="index.html">Home</a> ·
            <a href="tags.html">Tags</a> ·
            <a href="years.html">Years</a> ·
            <a href="about.html">About</a>
          </div>

          <div class="pure-u-1-3">
            <div class="contact">
              <span>
                <a href="https://github.com/lbrito1" download="">
                  <img src="assets/icons/github.svg" alt="Github icon">
                  </a>
              </span>
              <span>
                <a href="https://www.linkedin.com/in/leonardo-mendes-brito/">
                <img src="assets/icons/linkedin.svg" alt="LinkedIn icon">
                </a>
              </span>
            </div>
          </div>
        </nav>
        <div class="pure-g">
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2019/08/creating-more.html">My attempt at creating more</a></h2>

      <article class="text">
          <p>I began blogging in the now prehistoric late 2000s.</p>

<p>I’ve done a few blogs about different subjects (computer science, algorithms, web development, short stories and political ramblings). I’ve had blogs on Blogspot, Wordpress and, more recently, Medium.</p>

<p>Those platforms were (or are, I suppose) an easy way to spew your ideas over the Internet while also being nice and comfy for other people to actually read (this last point is important for the CSS-challenged such as yours truly). In other words, those services Got Shit Done™.</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/hello world">hello world</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2019/08/creating-more.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Aug 29, 2019</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2018/09/10-ways-not-to-do-a-big-deploy.html">10 ways not to do a big deploy</a></h2>

      <article class="text">
          <p>Ideally, deploys should be small, concise, easily revertible, fast and with a small or nil footprint on the database. However, no matter how awesome you are, sometimes that is just unattainable and you end up needing to deploy something that is just the opposite: big, messy, hard to revert, painfully slow and rubbing the DB the wrong way. If the deploy messes with a mission-critical part of your software, all the worse for you.</p>

<p>But there are actually many ways you can make those situations even worse. Here are a few bullet points you can follow to guarantee a nightmarish deploy complete with nasty side-effects that will haunt you and your coworkers for days to come.</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/Devops">Devops</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2018/09/10-ways-not-to-do-a-big-deploy.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Sep 03, 2018</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2019/01/halving-page-sizes-with-srcset.html">Halving page sizes with srcset</a></h2>

      <article class="text">
          <p><a href="https://www.webbloatscore.com/">Web bloat</a> is <a href="http://idlewords.com/talks/website_obesity.htm">discussed</a> a lot nowadays. Web pages with fairly straightforward content — such as a Google search results page — are substantially bigger today than they were a few decades ago, even though the content itself hasn’t changed that much. We, web developers, are at least partly to blame: laziness or just <a href="http://www.haneycodes.net/npm-left-pad-have-we-forgotten-how-to-program/">bad programming</a> are definitively part of the problem (of course, laziness might stem from a tight or impossible deadline, and bad code might come from inexperienced programmers — no judgment going on here).</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/Web development">Web development</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2019/01/halving-page-sizes-with-srcset.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Sep 03, 2018</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2018/06/working-remotely-in-a-non-remote-company.html">Working remotely in a non-remote company</a></h2>

      <article class="text">
          <p><img src="assets/images/goiabada/1*mgVZOuAHmp9Ipm2asL0IQQ.jpg" alt=""></p>

<p>We’re a small team here at Guava, and we’ve always considered ourselves <em>remote friendly.</em> Most of us work remotely every now and then pushed by varied <em>force majeure</em> situations— be it the flu, the need to supervise renovation or construction work at home, flash floods near the office, receiving guests at home or any number of other situations. We’ve also had a few of us working remotely for a few days or weeks while traveling to or back from a conference, or when visiting relatives that live out of town. In other words, remote working has always been a very temporary and circumstantial thing among us.</p>

<p>We have a nice office (with hammocks!), excellent work equipment, great desk space, comfortable chairs, plenty of snacks and comfort food and an infinite supply of coffee. We’re also easygoing and overall pleasant people (well, most of us are) to work with several hours a day, and some of us are even mildly funny.</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/Remote work">Remote work</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2018/06/working-remotely-in-a-non-remote-company.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Jun 12, 2018</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2018/03/the-5-stages-of-dealing-with-legacy-code.html">The 5 stages of dealing with legacy code</a></h2>

      <article class="text">
          <p>Yes, this article will use the <a href="https://en.wikipedia.org/wiki/K%C3%BCbler-Ross_model">5 stages of grief</a> as an analogy for something software development-related. There are at least a few thousand other articles with a similar motif (424,000 results for “grief stages software” according to <a href="https://www.google.es/search?q=grief+stages+software&amp;oq=grief+stages+software">Google</a>). But bear with me for the next 5 minutes and I promise you’ll get something out of this — if nothing else, at least the smirk of those who read their past follies put on text by someone else.</p>

<p>I have been working on a rather big Rails project for the past year and half. The project is nearly 7 years old, and has an all-too-common successful-startup-bought-by-industry-giant background story. In a project with this kind of background, some things are bound to happen: many developers of many skill ranges have come and gone, many software fads (cough, Meteor, cough), and above all else <em>a lot</em> of legacy code that is, well, let’s put it nicely, <em>not so great</em>. None of this should be taken personally in any way — it is just natural for such things to occur in such projects.</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/Legacy code">Legacy code</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2018/03/the-5-stages-of-dealing-with-legacy-code.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Mar 05, 2018</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2017/09/improving-spec-speed-in-a-huge-old-Rails-app.html">Improving spec speed in a huge, old Rails app</a></h2>

      <article class="text">
          <p>We got a 6-year-old Rails app with ~370k LOC and a ~6k-test suite which took 24 minutes to complete. Not good! We took a few days off of the main project to see if we could make things better.</p>

<p>More often than not, test suites are the nasty underbelly of a Rails app. Size and age just aggravate the problem. Tests are seldom a high priority in any project, and speed might not be an issue at all in smaller apps where the whole test suite might take just a few seconds to complete. As the project grows and the CI takes increasingly longer to complete, spec speed suddenly becomes more of an issue.</p>

<p>“Small” and “new” are not exactly the case for a certain Rails project we’re working on here at Guava. We’re talking about a 6-year-old e-commerce portal with ~370k LOC, a couple million customers and a ~6k-test, 300-spec suite which took, on average, a whopping 24 minutes to complete in our CI. <em>Not good!</em> So we took a couple of days off the main project to see if we could make things better — or less worse.</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/Ruby">Ruby</a>
            
              <a class="pure-button button-xsmall" href="tags/Rails">Rails</a>
            
              <a class="pure-button button-xsmall" href="tags/Software Engineering">Software Engineering</a>
            
              <a class="pure-button button-xsmall" href="tags/TDD">TDD</a>
            
              <a class="pure-button button-xsmall" href="tags/RSpec">RSpec</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2017/09/improving-spec-speed-in-a-huge-old-Rails-app.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Sep 04, 2017</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2017/06/how-a-Unix-CLI-tool-made-me-care-about-software-feedback.html">How a Unix CLI tool made me care about software feedback</a></h2>

      <article class="text">
          <p>Providing feedback is one of the most important parts of any software. Unfortunately, more often than not we tend to downplay or ignore the very simple yet crucial task of letting the user know what is going on. In this article I’ll use a short cautionary tale of how the lack of proper user feedback (and some laziness, I admit) almost cost me an entire HDD with years of personal data.</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/Software Engineering">Software Engineering</a>
            
              <a class="pure-button button-xsmall" href="tags/Unix">Unix</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2017/06/how-a-Unix-CLI-tool-made-me-care-about-software-feedback.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Jun 19, 2017</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2017/05/when-postgres-is-not-enough.html">When Postgres is not enough</a></h2>

      <article class="text">
          <p>What happens when your project’s RDBMS is just not enough to deal with unexpectedly huge amounts of data?</p>

<p>You could try to de-normalize some tables here and there to avoid unnecessary JOINs, create a few indexes, implement some kind of pagination or even pre-process the data into a more palatable format. However, if you did all that and it still was not enough, the “natural impulse” is to give up on the RDBMS altogether and just use Elasticsearch. Sounds like a no-brainer, right?</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/Ruby">Ruby</a>
            
              <a class="pure-button button-xsmall" href="tags/Software Engineering">Software Engineering</a>
            
              <a class="pure-button button-xsmall" href="tags/Postgresql">Postgresql</a>
            
              <a class="pure-button button-xsmall" href="tags/SQL">SQL</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2017/05/when-postgres-is-not-enough.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted May 08, 2017</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2017/03/dont-obsess-over-code-dry.html">Don't obsess over code DRYness</a></h2>

      <article class="text">
          <p>Being clever is a good thing for a developer. Ingenuity allows us to write software that solves complex real-world problems. However, “clever” <em>code</em> is not always a good thing. In many cases — I dare say in <em>most</em> cases — it is a very bad thing. I consciously try to avoid writing code that might be seen as “clever”. The smart thing to do is trying hard not to be smart (yes, very <a href="http://literarydevices.net/war-is-peace/">1984</a>).</p>

<p>Developers tend to see themselves (quite indulgently) as smart people. Not many people understand what we do, and society sees a developer as a kind of modern wizard, writing unreadable magic spells in a small metal box. In reality, though, we are not half as smart as we think: for instance, if you are a developer, you are certainly familiar with the frustration of trying to understand some cryptic piece of code that seemed perfectly reasonable and straightforward when you wrote it a couple of months earlier.</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/Ruby">Ruby</a>
            
              <a class="pure-button button-xsmall" href="tags/Software Engineering">Software Engineering</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2017/03/dont-obsess-over-code-dry.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Mar 20, 2017</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2015/10/building-a-shared-library-in-c-and-using-it-in-a-python-program.html">Building a shared library in C and using it in a Python program</a></h2>

      <article class="text">
          <p><a href="assets/images/codedeposit/2015/10/pathfinding.png"><img src="assets/images/codedeposit/2015/10/pathfinding.png?w=660" alt="pathfinding"></a></p>

<p>Figure 1</p>

<p>How do old-time languages such as C, Fortran and others survive in a world with Python, Ruby and so on?</p>

<p>There is&nbsp;plenty&nbsp;legacy code still around which need maintaining, of course. And there are (will always be?) a few specific applications where low level is needed. But&nbsp;one of the great things with software is building upon old stuff using new tools, which brings us to our topic today: building a shared library containing some of our C stuff and using it in nice and comfy Python. Figure 1 shows an example of what we can achieve by using graphical tools available in Python to improve our existing code’s text-based output. More on that later on.</p>

<p>For our purposes, we consider shared libraries as a collection of compiled objects condensed into a single file, which may then be called by other software. This is, of course, a simplification. A longer discussion about shared and static libraries can be found in [1].</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/c">c</a>
            
              <a class="pure-button button-xsmall" href="tags/linux">linux</a>
            
              <a class="pure-button button-xsmall" href="tags/python">python</a>
            
              <a class="pure-button button-xsmall" href="tags/reuse">reuse</a>
            
              <a class="pure-button button-xsmall" href="tags/shared library">shared library</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2015/10/building-a-shared-library-in-c-and-using-it-in-a-python-program.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Oct 28, 2015</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2015/10/red-black-vs-avl.html">Trees, part IV - Benchmarking Red-black and AVL trees</a></h2>

      <article class="text">
          <p>In our previous installments we implemented two of the most well-known self-balancing binary search trees: <a href="%7B%%20link%20_posts/2014-04-21-trees-part-ii-avl-tree.markdown%20%%7D">AVL</a> and <a href="%7B%%20link%20_posts/2015-10-01-trees-part-iii-red-black-tree.markdown%20%%7D">Red-black</a> <a href="%7B%%20link%20_posts/2014-03-31-trees-part-i.markdown%20%%7D">trees</a>.</p>

<p>We had a few classes on AVL trees in our basic data structures &amp; algorithms class back in college, which made its implementation far less of a challenge than the Red-black tree. So besides the fundamental guidance of CLRS I had to do quite some googling to get it working. While googling I noticed there were quite a lot of questions about which (AVL or RB) tree was “better” in some sense, be it insertion, search time, deletion time, etc. Most textbooks and articles dismiss this question just by stating the factor differences in either trees’ worst case heights, <a href="%7B%%20link%20_posts/2015-10-01-trees-part-iii-red-black-tree.markdown%20%%7D">as we briefly mentioned</a> in the past installment. If you’re anything like me, however, you’ll want to see some comparisons where the trees are <em>actually</em> tested. So I decided to do some simple benchmarking to test those theoretical worst-cases. Here’s what I found out.</p>


        <div class="post-tags">
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2015/10/red-black-vs-avl.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Oct 07, 2015</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2015/10/trees-part-iii-red-black-tree.html">Trees, part III - Red-black tree</a></h2>

      <article class="text">
          <p>In our last installment on trees, we studied and implemented the <a href="%7B%%20link%20_posts/2014-04-21-trees-part-ii-avl-tree.markdown%20%%7D">AVL tree</a>. The AVL tree is one of many <a href="https://en.wikipedia.org/wiki/Self-balancing_binary_search_tree">self-balancing binary search trees</a>, a special kind of BST that enforces sub-linear operation costs by maintaining tree height close to the theoretical minimum of $latex log_{2}(n)$. This is usually done by what is called <em>tree rotation</em>, which is basically moving around tree nodes (and updating some special node properties).</p>

<p>As you can see in the Wikipedia page¹, AVL trees guarantee that the tree height is strictly less than $latex \approx 1.44~log_{2}(n)$, while Red-black trees have a slightly worse threshold of $latex \approx 2~log_{2}(n)$; thus, AVL trees will provide significantly better search times than Red-black trees. However, while AVL trees may need to do $latex O(log(n))$ rotations after each insertion, Red-black trees must do at most 2 rotations per insertion. So either one may be your tree of choice depending on the application: if search time is critical but data doesn’t get updated too often, an AVL tree will perform better; whereas a Red-black tree will perform better in scenarios where data is constantly being changed.</p>

<p>Self-balancing BSTs add some kind of property to tree nodes that make way for tree balancing: with AVL trees, it was the “balance factor”. With Red-black trees, a “color” property is added to each node. This leads us to the <strong>Red-black tree properties</strong>:</p>

<ol>
  <li>Every node is either red or black</li>
  <li>Every leaf is black</li>
  <li>If a node is red, then both its children are black</li>
  <li>Every path from a node to any of its descendant leafs contains the same number of black nodes</li>
</ol>


        <div class="post-tags">
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2015/10/trees-part-iii-red-black-tree.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Oct 01, 2015</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2015/09/ruby-dsl-metaprogramming-part-ii.html">Ruby DSL &amp; metaprogramming, part II</a></h2>

      <article class="text">
          <p>In the previous installment we built a simple text generator using some Ruby meta-programming tricks. It was still far from being our desired context-free grammar (CFG) generator, though, since it lacked many <a href="https://www.cs.rochester.edu/~nelson/courses/csc_173/grammars/cfg.html">CFG prerequisites</a>. Most flagrantly, we had no rule recursion and only one production (rule definition) per rule. Here’s the what a script that would use both features:</p>

<div class="highlight"><pre><code class="language-bash">dictionary
  noun <span class="s1">'dog'</span>, <span class="s1">'bus'</span>
  verb <span class="s1">'barked'</span>, <span class="s1">'parked'</span>
  preposition <span class="s1">'at'</span>

rule <span class="s1">'phrase'</span>
  opt <span class="s1">'The'</span>, noun, verb, preposition, <span class="s1">'a'</span>, noun
  opt <span class="s1">'Here goes some'</span>, phrase, <span class="s1">'recursion.'</span>
  opt <span class="s1">'Meet me'</span>, preposition, <span class="s1">'the station.'</span>

grammar phrase: 10</code></pre></div>

<p>The <code>dictionary</code> section is just as we left it. Let’s see what changed in the <code>rule</code> section.</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/DSL">DSL</a>
            
              <a class="pure-button button-xsmall" href="tags/metaprogramming">metaprogramming</a>
            
              <a class="pure-button button-xsmall" href="tags/Ruby">Ruby</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2015/09/ruby-dsl-metaprogramming-part-ii.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Sep 20, 2015</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2015/09/ruby-dsl-metaprogramming-part-i.html">Ruby DSL &amp; metaprogramming, part I</a></h2>

      <article class="text">
          <p>I’ve been working with Ruby for nearly a year now, which means I’m starting to feel the urge to tell people how awesome the language is. One of the most interesting aspects of Ruby to me is <a href="https://en.wikipedia.org/wiki/Metaprogramming">metaprogramming</a>, which it seems to have quite a vocation for.</p>

<p>Since college I have a fondness for automata and formal languages theory. One of the topics I particularly like is text generation (if you haven’t already, check out the excellent <a href="http://pdos.csail.mit.edu/scigen/">SCIgen</a> and the <a href="http://dev.null.org/dadaengine/">Dada engine</a>), so I thought that building a Context-free grammar (CFG)-like text generator in Ruby would be a nice little exercise and an opportunity to use some of the language’s coolest features. Also I’ve implemented one of those using Java several years ago, and it was <em>a mess</em>, so I was curious as to how much of an improvement would Ruby offer.</p>

<p>Suppose the following script:</p>

<div class="highlight"><pre><code class="language-ruby"><span class="n">dictionary</span> <span class="s1">'noun'</span><span class="p">,</span> <span class="s1">'dog'</span><span class="p">,</span> <span class="s1">'bus'</span>
<span class="n">dictionary</span> <span class="s1">'verb'</span><span class="p">,</span> <span class="s1">'barked'</span><span class="p">,</span> <span class="s1">'parked'</span>
<span class="n">dictionary</span> <span class="s1">'preposition'</span><span class="p">,</span> <span class="s1">'at'</span>

<span class="n">rule</span> <span class="s1">'phrase'</span><span class="p">,</span> <span class="s1">'noun'</span><span class="p">,</span> <span class="s1">'verb'</span><span class="p">,</span> <span class="s1">'preposition'</span><span class="p">,</span> <span class="s1">'noun'</span>

<span class="n">codex</span> <span class="s1">'phrase'</span></code></pre></div>

<p>We’d like <code>dictionary</code> to store some words according to their classes, and <code>rule</code> to define a specific ordering of words. For now let’s not worry about <code>codex</code> (it’s just a collection of rules).</p>

<p>At this point the seasoned programmer is mentally sketching some kind of text parser. It’s an okay solution, but isn’t there something <em>nicer</em> we can do? Well, there is: <a href="https://en.wikipedia.org/wiki/Domain-specific_language">DSL</a>s! In fact, Ruby is quite an excellent tool to build a DSL, and many famed Ruby-powered applications such as Rspec (and <a href="http://www.leighhalliday.com/creating-ruby-dsl">many others</a>) define some kind of DSL.</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/DSL">DSL</a>
            
              <a class="pure-button button-xsmall" href="tags/metaprogramming">metaprogramming</a>
            
              <a class="pure-button button-xsmall" href="tags/Ruby">Ruby</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2015/09/ruby-dsl-metaprogramming-part-i.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Sep 11, 2015</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2014/04/trees-part-ii-avl-tree.html">Trees, Part II: AVL Tree</a></h2>

      <article class="text">
          <p>Masters classes started a few weeks ago, taking their&nbsp;toll on my productivity here. Sorry about that!</p>

<p>So we (pardon the&nbsp;<a href="http://en.wikipedia.org/wiki/Nosism">nosism</a>, but I think it sounds less egocentric&nbsp;than writing “I” all the time) hinted at AVL trees back on our <a href="%7B%%20link%20_posts/2014-03-31-trees-part-i.markdown%20%%7D">Trees, Part I</a>&nbsp;post. Specifically, we learned that:</p>

<blockquote>a binary search tree (BST), provides O(h) time search, insert and delete operations (h is the tree height.</blockquote>

<p>Linear time (O(h)) doesn’t sound very good - if h is close to n, we’ll have the same performance as a <a href="%7B%%20link%20_posts/2014-02-14-3.markdown%20%%7D%7D">linked list</a>.&nbsp;What if there were a way to&nbsp;bound the tree height&nbsp;to some sub-linear factor? As it turns out, there are several ways to do so, and the general idea of somehow&nbsp;keeping the tree height limited to a certain factor of the number of elements it holds is called height&nbsp;<strong>balancing</strong>. Ergo we’ll want to look into (height)&nbsp;<strong>balanced/self-balancing binary search trees **(BBST)</strong>.&nbsp;**</p>

<div class="highlight"><pre><code class="language-bash">                      Burger


                          M
                        <span class="nb">.</span>   <span class="nb">.</span>
                      <span class="nb">.</span>       <span class="nb">.</span>
                    <span class="nb">.</span>           <span class="nb">.</span>
                  <span class="nb">.</span>               <span class="nb">.</span>
                E <span class="nb">.</span>                 P <span class="nb">.</span>
              <span class="nb">.</span>     <span class="nb">.</span>                   <span class="nb">.</span>
            <span class="nb">.</span>         <span class="nb">.</span>                   <span class="nb">.</span>
          <span class="nb">.</span>             <span class="nb">.</span>                   <span class="nb">.</span>
      D <span class="nb">.</span>                 I                   Y
                        <span class="nb">.</span>
                      <span class="nb">.</span>
                    <span class="nb">.</span>
                  <span class="nb">.</span>
                F</code></pre></div>

<p><em>AVL tree</em></p>

<p>Since binary search trees have at most two children, the best tree height (i.e. smallest) we can achieve is log2 n (n being the number of elements in the tree). There are <a href="http://en.wikipedia.org/wiki/Self-balancing_binary_search_tree">several </a>self-balancing BSTs developed over the years. It seems that up there in the US college professors&nbsp;tend to prefer the red-black tree when studying BBSTs, whilst over here AVL is preferred. In any case, AVL tree was&nbsp;the first BBST ever devised, so we’ll adopt it as our BBST model.</p>

<p>AVL trees (named after its two Soviet inventors Adelson-Velsky and Landis) use a series of <strong>rotations</strong> to keep the tree balanced. To keep track of when a certain subtree rooted at some node needs to be rotated, we maintain (or calculate) a&nbsp;<strong>balance factor</strong> variable for each node, which is the difference between the node’s left and right children’s heights, i.e.:</p>

<p>balance_factor(n) = n.left_child.height - n.right_child.height</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/avl">avl</a>
            
              <a class="pure-button button-xsmall" href="tags/binary search tree">binary search tree</a>
            
              <a class="pure-button button-xsmall" href="tags/bst">bst</a>
            
              <a class="pure-button button-xsmall" href="tags/data structure">data structure</a>
            
              <a class="pure-button button-xsmall" href="tags/tree">tree</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2014/04/trees-part-ii-avl-tree.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Apr 21, 2014</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2014/04/shortest-path-part-i-dijkstras-algorithm.html">Shortest path, part I - Dijkstra's algorithm</a></h2>

      <article class="text">
          <p>Now that we have a way to represent <a href="%7B%%20link%20_posts/2014-03-23-graph.markdown%20%%7D">graphs</a>, we can discuss one of the most important problems in graph theory: the shortest path problem (SPP). More or less formally, we’ll define SPP as:</p>

<p>Given a weighted&nbsp;graph G(V,E), find the sequence P = {v0, v1, v2, …, v(n-1)}, vi ∈ V, from vertex V0 to vertex V(n-1), such that&nbsp;the list of edges&nbsp;EP = {(v0,v1), (v1,v2), … (v(n-2), v(n-1))} exists and the summation of costs of all elements e&nbsp;∈ EP is the smallest possible.</p>

<p>In other words, find the less expensive (ergo “shortest”)&nbsp;path between two vertices.</p>

<p>The trivial solution is using <a href="%7B%%20link%20_posts/2014-03-31-trees-part-i.markdown%20%%7D">BFS</a>&nbsp;starting at vertex A and stopping when it reaches vertex B. However, BFS doesn’t look at the edge costs: it calculates the path with&nbsp;least edges, not the path with least total cost.</p>

<p>Although not necessarily the fastest, Dijkstra’s algorithm is probably the most popular way to solve the shortest path problem due to its simplicity and elegance. The algorithm relies heavily on <a href="%7B%%20link%20_posts/2014-03-21-heap-priority-queues.markdown%20%%7D">priority queues</a>, so make sure to take a look at that if you haven’t already.</p>

<p><strong>Pseudocode</strong></p>

<div class="highlight"><pre><code class="language-bash">dist[from] <span class="o">=</span> 0
<span class="k">for </span>v : G
      <span class="k">if </span>v <span class="o">!=</span> <span class="nb">source
            </span>dist[v] <span class="o">=</span> infinity
      prev[v] <span class="o">=</span> <span class="nt">-1</span>
      PQ.add<span class="o">(</span>v, dist[v]<span class="o">)</span>
<span class="k">while </span>PQ.hasNext<span class="o">()</span>
      u <span class="o">=</span> PQ.pop<span class="o">()</span>
      <span class="k">for </span>each neighbor v of u
            alt <span class="o">=</span> dist[u] + length<span class="o">(</span>u, v<span class="o">)</span>
            <span class="k">if </span>alt &lt; dist[v]
                  dist[v] <span class="o">=</span> alt
                  prev[v] <span class="o">=</span> u
                  PQ.decrease_key<span class="o">(</span>v,alt<span class="o">)</span>
<span class="k">return </span>prev</code></pre></div>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/dijkstra">dijkstra</a>
            
              <a class="pure-button button-xsmall" href="tags/graph">graph</a>
            
              <a class="pure-button button-xsmall" href="tags/graph search">graph search</a>
            
              <a class="pure-button button-xsmall" href="tags/shortest path">shortest path</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2014/04/shortest-path-part-i-dijkstras-algorithm.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Apr 06, 2014</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2014/03/trees-part-i.html">Trees - Part I</a></h2>

      <article class="text">
          <p><a href="assets/images/codedeposit/2014/03/tree1.jpg"><img src="assets/images/codedeposit/2014/03/tree1.jpg" alt="tree"></a></p>

<p><a href="http://commons.wikimedia.org/wiki/File%3ABright_green_tree_-_Waikato.jpg"><img src="//upload.wikimedia.org/wikipedia/commons/thumb/f/f6/Bright_green_tree_-_Waikato.jpg/512px-Bright_green_tree_-_Waikato.jpg" alt="Bright green tree - Waikato"></a></p>

<p>We used trees to build the <a href="%7B%%20link%20_posts/2014-03-21-heap-priority-queues.markdown%20%%7D">heap data structure</a> before, but we didn’t bother with the theory behind trees, which are abstract and concrete data structures themselves. There’s a huge range of material to cover so I’ll split this in several posts.</p>

<p>In this first post we’ll cover the basic theory and implement a binary search tree (BST), which provides <code>O(h)</code> time search, insert and delete operations (<code>h</code> is the tree height). First, the basics:</p>

<p>Trees are graphs with a few extra properties and interpretations/conventions.
* Trees have height (longest branch length) and depth (distance to root).
* The uppermost level consists of at most one node (the tree root).
* All nodes may have children.
* There are no edges other than parent-child edges.</p>

<p>Trees are classified according to some&nbsp;of those properties above and some others we’ll mention later. Most commonly, there is a constraint to the maximum number of children per node -e.g. the binary tree limits children to 2 per node.

        </p><div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/abstract data structure">abstract data structure</a>
            
              <a class="pure-button button-xsmall" href="tags/bst">bst</a>
            
              <a class="pure-button button-xsmall" href="tags/data structure">data structure</a>
            
              <a class="pure-button button-xsmall" href="tags/graph">graph</a>
            
              <a class="pure-button button-xsmall" href="tags/tree">tree</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2014/03/trees-part-i.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Mar 31, 2014</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2014/03/graph.html">Graph</a></h2>

      <article class="text">
          <p>Mathematically, a graph is a set of vertices and edges, thus a graph <code>G</code> is usually written as <code>G(V,E)</code>. Besides linking vertices in the graph, edges can also carry a specific value which may be interpreted as cost, weight, distance etc.</p>

<p><a href="assets/images/codedeposit/2014/03/graph1.jpg"><img src="assets/images/codedeposit/2014/03/graph1.jpg" alt="graph viewed with BurgerGFX"></a></p>

<p>In computer science, we’re interested in the (abstract) data structure used to implement the graph mathematical concept. Let’s first discuss the basic elements in a graph - vertices and edges:</p>

<div class="highlight"><pre><code class="language-c"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">vertex</span>
<span class="p">{</span>
 <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">id</span><span class="p">;</span>
 <span class="kt">int</span> <span class="n">status</span><span class="p">;</span>
 <span class="kt">double</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">;</span>
 <span class="kt">void</span><span class="o">*</span> <span class="n">data</span><span class="p">;</span>
<span class="p">}</span> <span class="n">vertex</span><span class="p">;</span></code></pre></div>

<p>Vertices should be able to hold any kind of data, so we’ll just throw in a void pointer for that. Other than that we have an id, status (marked or unmarked - more on that later) and 2D coordinates so we can draw the vertices somewhere.</p>

<div class="highlight"><pre><code class="language-c"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">edge</span>
<span class="p">{</span>
 <span class="n">vertex</span><span class="o">*</span> <span class="n">from</span><span class="p">,</span> <span class="o">*</span><span class="n">to</span><span class="p">;</span>
 <span class="kt">int</span> <span class="n">cost</span><span class="p">;</span>
<span class="p">}</span> <span class="n">edge</span><span class="p">;</span></code></pre></div>

<p>Edges consist of just pointers to the vertices they link and an optional value used as weight, distance, cost etc. Strictly speaking we could use a void pointer for that value as well, as long as we also defined a comparison function. But let’s save the hassle and just use an integer instead - most algorithms will be fine with that.</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/data structure">data structure</a>
            
              <a class="pure-button button-xsmall" href="tags/graph">graph</a>
            
              <a class="pure-button button-xsmall" href="tags/graph theory">graph theory</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2014/03/graph.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Mar 23, 2014</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2014/03/heap-priority-queues.html">Heap &amp; Priority Queues</a></h2>

      <article class="text">
          <p>Priority queues (PQs) are abstract data types that work just like regular stacks, but the popping order depends on each element’s priority instead of the sequence they were pushed onto the queue (FIFO or LIFO).</p>

<p>The naïve way of implementing a PQ consists of using an unsorted list or array and searching for the highest-priority element at each pop, which takes O(n) time. There are several more efficient implementations, of which the most usual is the heap.</p>

<p>Heaps are complete (i.e. all levels except possibly the last are filled) binary trees that work as PQs by maintaining the following property: children nodes always have a smaller priority than their parent, i.e. for any node A with children B and C, priority(B) &lt; priority(A) &amp;&amp; priority(C) &lt; priority(A). Note that there is no assumed relation between siblings or cousins.</p>

<p><a href="assets/images/codedeposit/2014/03/heap.jpg"><img src="assets/images/codedeposit/2014/03/heap.jpg" alt="max-heap and corresponding array."></a>
<em>max-heap and corresponding array.</em></p>

<p>Each element of a heap has two pieces of information: a key and a value, hence we call them key-value (KV) pair. The key identifies the specific element, and the value determines the element’s priority within the heap. Heaps can be min-heaps (low value = high priority) or max-heaps (high value = high priority).</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/abstract data structure">abstract data structure</a>
            
              <a class="pure-button button-xsmall" href="tags/data structure">data structure</a>
            
              <a class="pure-button button-xsmall" href="tags/heap">heap</a>
            
              <a class="pure-button button-xsmall" href="tags/priority queue">priority queue</a>
            
              <a class="pure-button button-xsmall" href="tags/queue">queue</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2014/03/heap-priority-queues.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Mar 21, 2014</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2014/03/burgergfx-simple-2d-graphics.html">BurgerGFX - simple 2D graphics</a></h2>

      <article class="text">
          <p><a href="assets/images/codedeposit/2014/03/burger_gfx1.jpg"><img src="assets/images/codedeposit/2014/03/burger_gfx1.jpg" alt="sample code and output"></a></p>

<p>Several times I find myself wanting to visualize something in 2D, but can’t bother to fire up OpenGL or other cumbersome API.</p>

<p>So I wrote a simple program which I called BurgerGFX, with 2 core functionalities: draw point and draw line. I find this to be quite enough for simple applications such as viewing a graph.</p>

<p>Setting up the drawing canvas, which I call burger, is simple: call create(width, height), which returns a pointer to the burger. Then simply call the draws, prints and cleans as needed.</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/graphics">graphics</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2014/03/burgergfx-simple-2d-graphics.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Mar 18, 2014</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2014/03/stack.html">Stack</a></h2>

      <article class="text">
          <p>Using our implementation of a doubly linked (DL) list, we can very simply build the most basic LIFO (last in, first out) data structure: the stack.</p>

<p><a href="assets/images/codedeposit/2014/03/stack.png"><img src="assets/images/codedeposit/2014/03/stack.png?w=300" alt="stack"></a></p>

<p>Stacks have two basic operations: push and pop. Push pushes data onto the stack (i.e., end of the DL list) and pop pops data off the list’s tail, which is only possible because we can set the new tail as tail-&gt;prev, since we’re using a DL list, with previous pointers. Another useful function is peek, which returns a pointer to the stack’s top.</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/abstract data structure">abstract data structure</a>
            
              <a class="pure-button button-xsmall" href="tags/data structure">data structure</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2014/03/stack.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Mar 18, 2014</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2014/03/doubly-linked-list.html">Doubly linked list</a></h2>

      <article class="text">
          <p>A doubly linked list is like our previously implemented Linked List, but instead of only having pointers to the next element, it also has pointers to the _previous _element:</p>

<p><a href="assets/images/codedeposit/2014/03/610px-doubly-linked-list-svg.png"><img src="assets/images/codedeposit/2014/03/610px-doubly-linked-list-svg.png" alt="610px-Doubly-linked-list.svg"></a></p>

<p>This property makes the doubly linked list very useful as a base for other data structures such as the stack: having a previous pointer means we can quickly (O(1)) remove objects from the list’s tail, which would be impossible with a linked list.</p>

<p>We won’t discuss implementation since it so similar to a linked list. If anything implementation is even simpler than a linked list because of the previous pointer access.</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/data structure">data structure</a>
            
              <a class="pure-button button-xsmall" href="tags/list">list</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2014/03/doubly-linked-list.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Mar 18, 2014</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2014/02/vector.html">Vector</a></h2>

      <article class="text">
          <p>Very simple Vector implementation with add, add_all, get and delete operations using arrays of void pointers.</p>

<p>The downside to this as compared to simply using an array is that here we have an <em>array of pointers</em>, which means the data will most likely be scattered over the memory, not coalesced.</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/data structure">data structure</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2014/02/vector.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Feb 21, 2014</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2014/02/mergesort.html">Mergesort</a></h2>

      <article class="text">
          <p>Mergesort is an important sorting algorithm when you don’t have efficient random memory access, since it doesn’t rely on that and has good time complexity - O(n logn) specifically.</p>

<p>As a typical divide-and-conquer algorithm, Mergesort has two steps: first it recursively splits the lists in two until each half is unitary, then it recursively mends back the lists until it reaches the original size.</p>

<p>But before we dive into the actual algorithm, we need to make some changes to the linked list algorithm we’ll be using.</p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/sorting algorithm">sorting algorithm</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2014/02/mergesort.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Feb 21, 2014</aside>

          </div>
        </div>
      </article>
    </div>
  
    <div class="post-index pure-u-1-1">
      <h2><a href="2014/02/linked-list.html">Linked List</a></h2>

      <article class="text">
          <p>Here’s a very simple implementation of the linked list data structure.</p>

<p>A pointer to the head element is enough to define a linked list. Each element consists of one pointer to the subsequent element in the list and one pointer to the element’s data:</p>

<p><a href="assets/images/codedeposit/2014/02/linkedlist.png"><img src="assets/images/codedeposit/2014/02/linkedlist.png?w=450" alt="linkedlist"></a></p>


        <div class="post-tags">
          
            <div class="tags">
            
              <a class="pure-button button-xsmall" href="tags/data structure">data structure</a>
            
              <a class="pure-button button-xsmall" href="tags/list">list</a>
            
            </div>
          
        </div>

        <div class="pure-g post-footer">
          <div class="pure-u-1-2">
              <a class="read-more" href="2014/02/linked-list.html">Continue reading ›</a>
          </div>
          <div class="pure-u-1-2 post-meta">
            <aside>Posted Feb 14, 2014</aside>

          </div>
        </div>
      </article>
    </div>
  
</div>


        <div class="footer">
          2020 Leonardo Brito
        </div>
      </div>

    </div>
  

</body></html>